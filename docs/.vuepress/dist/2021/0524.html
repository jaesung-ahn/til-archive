<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>0524 - 0530 | TIL</title>
    <meta name="generator" content="VuePress 1.8.0">
    
    <meta name="description" content="
0524 - 클라우드에 도커이미지 배포하기
요구사항
15분
JDK 1.8 이상
Gradle 4+ 또는 Maven 3.2+
Spring Toll Suite 또는 IntelliJ IDEA

도커 파일 생성
FROM openjdk:8-jdk-alpine
ARG JAR_FILE=target/*.jar
COPY ...">
    
    <link rel="preload" href="/TIL/assets/css/0.styles.9729072d.css" as="style"><link rel="preload" href="/TIL/assets/js/app.face42bf.js" as="script"><link rel="preload" href="/TIL/assets/js/6.5d7ec74f.js" as="script"><link rel="preload" href="/TIL/assets/js/11.eca71194.js" as="script"><link rel="preload" href="/TIL/assets/js/26.1b3a0d64.js" as="script"><link rel="prefetch" href="/TIL/assets/js/10.5c95ce33.js"><link rel="prefetch" href="/TIL/assets/js/12.44862a55.js"><link rel="prefetch" href="/TIL/assets/js/13.3354667d.js"><link rel="prefetch" href="/TIL/assets/js/14.ebd32721.js"><link rel="prefetch" href="/TIL/assets/js/15.9a5da76a.js"><link rel="prefetch" href="/TIL/assets/js/16.0ec9d5c5.js"><link rel="prefetch" href="/TIL/assets/js/17.197aed0f.js"><link rel="prefetch" href="/TIL/assets/js/18.ac1d8f71.js"><link rel="prefetch" href="/TIL/assets/js/19.52554e37.js"><link rel="prefetch" href="/TIL/assets/js/20.d49a3176.js"><link rel="prefetch" href="/TIL/assets/js/21.703e3b5b.js"><link rel="prefetch" href="/TIL/assets/js/22.b15b40cf.js"><link rel="prefetch" href="/TIL/assets/js/23.f660074b.js"><link rel="prefetch" href="/TIL/assets/js/24.7cae7b6d.js"><link rel="prefetch" href="/TIL/assets/js/25.4544b20e.js"><link rel="prefetch" href="/TIL/assets/js/27.ef321cf3.js"><link rel="prefetch" href="/TIL/assets/js/28.6559ba71.js"><link rel="prefetch" href="/TIL/assets/js/29.724725e7.js"><link rel="prefetch" href="/TIL/assets/js/3.70c77cf4.js"><link rel="prefetch" href="/TIL/assets/js/30.a52d1089.js"><link rel="prefetch" href="/TIL/assets/js/31.198eeb03.js"><link rel="prefetch" href="/TIL/assets/js/32.1c678662.js"><link rel="prefetch" href="/TIL/assets/js/33.f3411971.js"><link rel="prefetch" href="/TIL/assets/js/34.92db02e4.js"><link rel="prefetch" href="/TIL/assets/js/35.e45ae628.js"><link rel="prefetch" href="/TIL/assets/js/36.454a23c3.js"><link rel="prefetch" href="/TIL/assets/js/37.0853aeff.js"><link rel="prefetch" href="/TIL/assets/js/38.f4787dfc.js"><link rel="prefetch" href="/TIL/assets/js/39.fa931ac4.js"><link rel="prefetch" href="/TIL/assets/js/4.851786b4.js"><link rel="prefetch" href="/TIL/assets/js/40.2f2b7cc1.js"><link rel="prefetch" href="/TIL/assets/js/41.af69bea0.js"><link rel="prefetch" href="/TIL/assets/js/42.266b80d2.js"><link rel="prefetch" href="/TIL/assets/js/43.9eca0436.js"><link rel="prefetch" href="/TIL/assets/js/44.3c9dd560.js"><link rel="prefetch" href="/TIL/assets/js/45.839c0213.js"><link rel="prefetch" href="/TIL/assets/js/46.44355db1.js"><link rel="prefetch" href="/TIL/assets/js/47.fb2d1489.js"><link rel="prefetch" href="/TIL/assets/js/48.117f6110.js"><link rel="prefetch" href="/TIL/assets/js/49.f5f58c80.js"><link rel="prefetch" href="/TIL/assets/js/5.a40fa64b.js"><link rel="prefetch" href="/TIL/assets/js/50.bf663577.js"><link rel="prefetch" href="/TIL/assets/js/51.c3bdfcaa.js"><link rel="prefetch" href="/TIL/assets/js/52.5a372c16.js"><link rel="prefetch" href="/TIL/assets/js/53.796d7943.js"><link rel="prefetch" href="/TIL/assets/js/54.c46aa092.js"><link rel="prefetch" href="/TIL/assets/js/55.3e3ec3b1.js"><link rel="prefetch" href="/TIL/assets/js/56.e7675ae5.js"><link rel="prefetch" href="/TIL/assets/js/57.7e5b274a.js"><link rel="prefetch" href="/TIL/assets/js/58.8674754f.js"><link rel="prefetch" href="/TIL/assets/js/59.b922d1c3.js"><link rel="prefetch" href="/TIL/assets/js/60.7ce728db.js"><link rel="prefetch" href="/TIL/assets/js/61.e69f607b.js"><link rel="prefetch" href="/TIL/assets/js/62.f6f4222a.js"><link rel="prefetch" href="/TIL/assets/js/63.e9323ce2.js"><link rel="prefetch" href="/TIL/assets/js/64.d0c85d08.js"><link rel="prefetch" href="/TIL/assets/js/65.a9819011.js"><link rel="prefetch" href="/TIL/assets/js/66.c87d09bc.js"><link rel="prefetch" href="/TIL/assets/js/67.7ca58cbd.js"><link rel="prefetch" href="/TIL/assets/js/68.321ea5a8.js"><link rel="prefetch" href="/TIL/assets/js/69.a7741122.js"><link rel="prefetch" href="/TIL/assets/js/7.fda50c33.js"><link rel="prefetch" href="/TIL/assets/js/70.bdeee399.js"><link rel="prefetch" href="/TIL/assets/js/71.f312da68.js"><link rel="prefetch" href="/TIL/assets/js/72.91f45247.js"><link rel="prefetch" href="/TIL/assets/js/73.88953b79.js"><link rel="prefetch" href="/TIL/assets/js/74.d1611c1b.js"><link rel="prefetch" href="/TIL/assets/js/75.37f9e0f8.js"><link rel="prefetch" href="/TIL/assets/js/76.dc32c379.js"><link rel="prefetch" href="/TIL/assets/js/77.5433e0a6.js"><link rel="prefetch" href="/TIL/assets/js/78.6fda6ca0.js"><link rel="prefetch" href="/TIL/assets/js/79.3e50b7b1.js"><link rel="prefetch" href="/TIL/assets/js/8.584bc921.js"><link rel="prefetch" href="/TIL/assets/js/80.18405258.js"><link rel="prefetch" href="/TIL/assets/js/81.e4ccf68a.js"><link rel="prefetch" href="/TIL/assets/js/82.6b7c1912.js"><link rel="prefetch" href="/TIL/assets/js/83.34d29caa.js"><link rel="prefetch" href="/TIL/assets/js/84.ee39d9de.js"><link rel="prefetch" href="/TIL/assets/js/85.1184af6c.js"><link rel="prefetch" href="/TIL/assets/js/86.138caca8.js"><link rel="prefetch" href="/TIL/assets/js/87.038c2438.js"><link rel="prefetch" href="/TIL/assets/js/9.ad0ae255.js"><link rel="prefetch" href="/TIL/assets/js/vuejs-paginate.e9164293.js">
    <link rel="stylesheet" href="/TIL/assets/css/0.styles.9729072d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-blog__global-layout"><section id="header-wrapper"><header id="header"><div class="header-wrapper"><div class="title"><a href="/TIL/" class="nav-link home-link">TIL </a></div> <div class="header-right-wrap"><ul class="nav"><li class="nav-item"><a href="https://github.com/jaesungahn91" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li><li class="nav-item"><a href="https://velog.io/@ahnjs" target="_blank" rel="noopener noreferrer" class="nav-link external">Blog</a></li></ul> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></div></header></section> <div id="mobile-header"><div class="mobile-header-bar"><div class="mobile-header-title"><a href="/TIL/" class="nav-link mobile-home-link">TIL </a> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg></div> <div class="mobile-menu-wrapper"><hr class="menu-divider"> <ul class="mobile-nav"><li class="mobile-nav-item"><a href="https://github.com/jaesungahn91" target="_blank" rel="noopener noreferrer" class="nav-link external">GitHub</a></li><li class="mobile-nav-item"><a href="https://velog.io/@ahnjs" target="_blank" rel="noopener noreferrer" class="nav-link external">Blog</a></li> <li class="mobile-nav-item"><!----></li></ul></div></div></div> <div class="content-wrapper"><div><div class="content__default"><h1 id="_0524-0530"><a href="#_0524-0530" class="header-anchor">#</a> 0524 - 0530</h1> <h2 id="_0524-클라우드에-도커이미지-배포하기"><a href="#_0524-클라우드에-도커이미지-배포하기" class="header-anchor">#</a> 0524 - 클라우드에 도커이미지 배포하기</h2> <h3 id="요구사항"><a href="#요구사항" class="header-anchor">#</a> 요구사항</h3> <ul><li>15분</li> <li>JDK 1.8 이상</li> <li>Gradle 4+ 또는 Maven 3.2+</li> <li>Spring Toll Suite 또는 IntelliJ IDEA</li></ul> <h3 id="도커-파일-생성"><a href="#도커-파일-생성" class="header-anchor">#</a> 도커 파일 생성</h3> <div class="language-Docker extra-class"><pre class="language-docker"><code><span class="token keyword">FROM</span> openjdk<span class="token punctuation">:</span>8<span class="token punctuation">-</span>jdk<span class="token punctuation">-</span>alpine
<span class="token keyword">ARG</span> JAR_FILE=target/*.jar
<span class="token keyword">COPY</span> $<span class="token punctuation">{</span>JAR_FILE<span class="token punctuation">}</span> app.jar
<span class="token keyword">ENTRYPOINT</span> <span class="token punctuation">[</span><span class="token string">&quot;java&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;-jar&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;/app.jar&quot;</span><span class="token punctuation">]</span>
</code></pre></div><h3 id="docker-command"><a href="#docker-command" class="header-anchor">#</a> docker command</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>// 빌드
docker build -t sung431/spring-boot-cpu-bound <span class="token builtin class-name">.</span>

// 로컬 실행
docker run -p <span class="token number">80</span>:80 sung431/spring-boot-cpu-bound

// 도커 로그인
docker login

// 원격저장소에 등록
docker push sung431/spring-boot-cpu-bound
</code></pre></div><h3 id="도커-설치-및-실행"><a href="#도커-설치-및-실행" class="header-anchor">#</a> 도커 설치 및 실행</h3> <div class="language-shell extra-class"><pre class="language-shell"><code>// 설치
<span class="token function">sudo</span> yum <span class="token function">install</span> docker

// 실행
<span class="token function">sudo</span> systemctl start docker

// 이미지 받아오기
<span class="token function">sudo</span> docker pull sung431/spring-boot-cpu-bound

// 도커 이미지 실행
<span class="token function">sudo</span> docker run -p <span class="token number">80</span>:80 sung431/spring-boot-cpu-bound
</code></pre></div><br> <h2 id="_0525-mac-node-완전히-삭제"><a href="#_0525-mac-node-완전히-삭제" class="header-anchor">#</a> 0525 - (Mac) Node 완전히 삭제</h2> <ol><li>shell을 열어 두 줄의 코드를 입력한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code> lsbom -f -l -s -pf /var/db/receipts/org.nodejs.pkg.bom | while read f; do  sudo rm /usr/local/${f}; done
 sudo rm -rf /usr/local/lib/node /usr/local/lib/node_modules /var/db/receipts/org.nodejs.*
</code></pre></div><ol start="2"><li>/usr/local/lib 에 있는 node로 시작하는 directory를 삭제한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code> cd /usr/local/lib
 sudo rm -rf node*

 sudo rm -rf /usr/local/{lib/node{,/.npm,_modules},bin,share/man}/{npm*,node*,man1/node*}
 sudo rm -rf /usr/local/bin/npm /usr/local/share/man/man1/node* /usr/local/lib/dtrace/node.d ~/.npm ~/.node-gyp

 /usr/local/lib 로 이동하여 node 및 node_modules를 삭제
 /usr/local/include 로 이동하여 node 및 node_modules 디렉토리를 삭제
 brew install node로 설치 한 경우 터미널에서 brew uninstall node 를 실행
 홈 디렉토리에 로컬 또는 lib 또는 포함 폴더가 있는지 확인 하고 거기에서 node 또는 node_modules 를 삭제
 /usr/local/bin으로 이동하여 모든 노드 실행 파일을 삭제

 sudo rm -rf /opt/local/bin/node /opt/local/include/node /opt/local/lib/node_modules
 sudo rm -rf /usr/local/bin/npm /usr/local/share/man/man1/node.1 /usr/local/lib/dtrace/node.d
</code></pre></div><ol start="3"><li>/usr/local/include에 있는 node로 시작하는 directory를 삭제한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>cd /usr/local/include
sudo rm -rf node*
</code></pre></div><ol start="4"><li>brew에 설치된 node를 삭제한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>brew uninstall node
</code></pre></div><ol start="5"><li>/usr/local/bin 에 있는 node 또는 node_modules를 삭제한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>sudo rm -rf /usr/local/bin/npm
sudo rm -rf /usr/local/bin/node
ls -las
</code></pre></div><ol start="6"><li>추가적인 것들을 삭제한다.</li></ol> <div class="language- extra-class"><pre class="language-text"><code>sudo rm -rf /usr/local/share/man/man1/node.1
sudo rm -rf /usr/local/lib/dtrace/node.d
sudo rm -rf ~/.npm
sudo rm -rf ~/.nvm
rm -rf ~/.node-gyp
</code></pre></div><br> <h2 id="_0526-nvm-node-version-manager"><a href="#_0526-nvm-node-version-manager" class="header-anchor">#</a> 0526 - nvm(Node Version Manager)</h2> <h3 id="nvm-설치"><a href="#nvm-설치" class="header-anchor">#</a> nvm 설치</h3> <ul><li><p>git</p> <ul><li>https://github.com/nvm-sh/nvm</li></ul></li> <li><p>설치</p></li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token function">curl</span> -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh <span class="token operator">|</span> <span class="token function">bash</span>
</code></pre></div><ul><li>환경변수 설정</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">NVM_DIR</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable"><span class="token variable">$(</span><span class="token punctuation">[</span> -z <span class="token string">&quot;<span class="token variable">${XDG_CONFIG_HOME-}</span>&quot;</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">printf</span> %s <span class="token string">&quot;<span class="token variable">${<span class="token environment constant">HOME</span>}</span>/.nvm&quot;</span> <span class="token operator">||</span> <span class="token builtin class-name">printf</span> %s <span class="token string">&quot;<span class="token variable">${XDG_CONFIG_HOME}</span>/nvm&quot;</span><span class="token variable">)</span></span>&quot;</span>
<span class="token punctuation">[</span> -s <span class="token string">&quot;<span class="token variable">$NVM_DIR</span>/nvm.sh&quot;</span> <span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">\</span>. <span class="token string">&quot;<span class="token variable">$NVM_DIR</span>/nvm.sh&quot;</span> <span class="token comment"># This loads nvm</span>
</code></pre></div><p>적용</p> <div class="language-sh extra-class"><pre class="language-sh"><code>bash: <span class="token builtin class-name">source</span> ~/.bashrc
      <span class="token builtin class-name">source</span> ~/.bash_profile  

zsh: <span class="token builtin class-name">source</span> ~/.zshrc

ksh: <span class="token builtin class-name">.</span> ~/.profile
</code></pre></div><h3 id="옵션-및-사용-방법"><a href="#옵션-및-사용-방법" class="header-anchor">#</a> 옵션 및 사용 방법</h3> <ul><li>node.js 설치</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>nvm <span class="token function">install</span> <span class="token punctuation">{</span>version<span class="token punctuation">}</span>
nvm <span class="token function">install</span> <span class="token number">12.13</span>.1
</code></pre></div><ul><li>node 목록 확인</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>nvm <span class="token function">ls</span>
</code></pre></div><ul><li>사용 버전 지정</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>nvm use <span class="token number">12.13</span>.1
</code></pre></div><br> <h2 id="_0527-bash-zsh-환경변수-따로-등록되어-있을때"><a href="#_0527-bash-zsh-환경변수-따로-등록되어-있을때" class="header-anchor">#</a> 0527 - bash, zsh 환경변수 따로 등록되어 있을때</h2> <ul><li>각 환경별 환경변수 설정</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code>~/.bash_profile
~/.zshrc
</code></pre></div><p>따라서 bash 환경설정에 변수를 설정하고 zsh 환경에서 실행했을경우
당연히 실행하고자하는 커맨드는 <code>zsh: command not found</code> 가 됨</p> <ul><li>zshrc에서 bash가 작동하도록 등록</li></ul> <div class="language-sh extra-class"><pre class="language-sh"><code><span class="token keyword">if</span> <span class="token punctuation">[</span> -f ~/.bash_profile <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span> <span class="token builtin class-name">source</span> ~/.bash_profile<span class="token punctuation">;</span> <span class="token keyword">fi</span>
</code></pre></div><br> <h2 id="_0528-postgres-data-directory-변경"><a href="#_0528-postgres-data-directory-변경" class="header-anchor">#</a> 0528 - postgres data_directory 변경</h2> <ol><li>현재 data directory 확인</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code>$ psql
<span class="token assign-left variable">postgres</span><span class="token operator">=</span><span class="token comment"># show data_directory;</span>
</code></pre></div><ol start="2"><li>기존 데이터 복사</li></ol> <div class="language-sh extra-class"><pre class="language-sh"><code> <span class="token function">mv</span> 현재디렉토리 옮길디렉토리
</code></pre></div><ol start="3"><li>환경변수 또는 설정파일 변경
<ul><li>PGDATA 환경변수 변경</li> <li>postgres config파일 변경</li></ul></li></ol></div></div></div> <footer class="footer" data-v-3d9deeb8><div class="footer-left-wrap" data-v-3d9deeb8><ul class="contact" data-v-3d9deeb8></ul></div> <div class="footer-right-wrap" data-v-3d9deeb8><ul class="copyright" data-v-3d9deeb8></ul></div></footer></div><div class="global-ui"></div></div>
    <script src="/TIL/assets/js/app.face42bf.js" defer></script><script src="/TIL/assets/js/6.5d7ec74f.js" defer></script><script src="/TIL/assets/js/11.eca71194.js" defer></script><script src="/TIL/assets/js/26.1b3a0d64.js" defer></script>
  </body>
</html>
